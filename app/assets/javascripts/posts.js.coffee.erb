showPreview = ->
  PostPreviewer.showPreviewFor
    text: '#text'
    preview: '#preview'
    url: $('#text').attr('data-preview_path')

$(document).ready ->
  if $('#text').length == 1
    showPreview()
  typeWatchOptions =
    callback: showPreview
    wait: 250
    captureLength: 0
  $('#text').typeWatch typeWatchOptions

jQuery ->
  marker = $('#pagination_marker')
  if marker.length > 0
    $('#pagination_links').remove()
    url = marker.attr('data-start_url')
    scroller = new InfiniteScroll(url: url, paginationMarker: marker)
    scroller.setObserver()
